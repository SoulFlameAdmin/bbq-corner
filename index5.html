<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Corner BBQ ‚Äî Rebuild</title>
<style>
  :root{ --bg:#0e0f10; --soft:#ffffff1a; --accent:#ff7a00; --text:#fff; }
  *{box-sizing:border-box}
  body{margin:0;min-height:100vh;display:grid;place-items:center;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .card{width:min(480px,92vw);background:#121316;border:1px solid var(--soft);border-radius:16px;padding:20px;box-shadow:0 10px 28px rgba(0,0,0,.28)}
  h1{margin:0 0 6px;font-size:18px;color:var(--accent)}
  p{margin:0 0 16px;opacity:.9}
  .row{display:flex;gap:10px;align-items:center}
  button{
    background:#181a1f;border:1px solid var(--soft);color:#fff;border-radius:12px;padding:12px 16px;
    font-weight:900;cursor:pointer
  }
  button:hover{border-color:#ffffff44}
  button[disabled]{opacity:.6;cursor:not-allowed}
  .ok{color:#9eff8b}
  .err{color:#ff8b8b}
  .spin{width:16px;height:16px;border:3px solid #ffffff33;border-top-color:#fff;border-radius:50%;display:inline-block;animation:spin 0.9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
  <div class="card">
    <h1>üöÄ Rebuild —Å–∞–π—Ça</h1>
    <p>–ù–∞—Ç–∏—Å–Ω–∏ –±—É—Ç–æ–Ω–∞, –∑–∞ –¥–∞ –∑–∞–¥–µ–π—Å—Ç–≤–∞—à –º–æ–º–µ–Ω—Ç–∞–ª–µ–Ω deploy –≤—ä–≤ Vercel.</p>
    <div class="row">
      <button id="rebuildBtn">–û–±–Ω–æ–≤–∏ —Å–µ–≥–∞</button>
      <span id="status"></span>
    </div>
  </div>

<script>
const btn = document.getElementById('rebuildBtn');
const statusE = document.getElementById('status');

// –∞–∫–æ —Å–∏ —Å–ª–æ–∂–∏–ª REBUILD_CLIENT_KEY –≤—ä–≤ Vercel, –Ω–∞–ø–∏—à–∏ —Å—ä—â–∏—è —Ç—É–∫:
const CLIENT_KEY = ''; // –ø—Ä–∏–º–µ—Ä: 'mitko-rocket-2025' (–æ—Å—Ç–∞–≤–∏ –ø—Ä–∞–∑–Ω–æ –∞–∫–æ –Ω–µ –ø–æ–ª–∑–≤–∞—à –∫–ª—é—á)

btn.onclick = async () => {
  btn.disabled = true;
  statusE.innerHTML = '<span class="spin"></span> –ó–∞–¥–µ–π—Å—Ç–≤–∞–º‚Ä¶';
  try{
    const res = await fetch('/api/rebuild', {
      method: 'POST',
      headers: CLIENT_KEY ? {'x-rebuild-key': CLIENT_KEY} : {}
    });
    const data = await res.json().catch(()=>({}));
    if (res.ok && data.ok){
      statusE.innerHTML = '<b class="ok">–ì–æ—Ç–æ–≤–æ ‚Äì –±–∏–ª–¥—ä—Ç —Å—Ç–∞—Ä—Ç–∏—Ä–∞!</b>';
    } else {
      statusE.innerHTML = '<b class="err">–ì—Ä–µ—à–∫–∞:</b> ' + (data.error || (res.status + ' ' + res.statusText));
    }
  }catch(e){
    statusE.innerHTML = '<b class="err">–ì—Ä–µ—à–∫–∞:</b> ' + (e?.message || e);
  }finally{
    setTimeout(()=>{ btn.disabled = false; }, 1500);
  }
};
</script>
</body>
</html>
